<html>
<head>
<title>HTA Link Scraper com XMLHTTP</title>
<HTA:APPLICATION
  ID="LinkScraper"
  APPLICATIONNAME="HTALinkScraper"
  BORDER="thin"
  CAPTION="yes"
  SHOWINTASKBAR="yes"
  SINGLEINSTANCE="yes"
  SYSMENU="yes"
  WINDOWSTATE="normal"
/>
<script language="VBScript">
Sub ScrapeLinks()
  Dim url, http, htmlDoc, links, i, linkList, linkHref

  url = document.getElementById("urlInput").value
  If url = "" Then
    MsgBox "Por favor, insira uma URL válida."
    Exit Sub
  End If

  Set http = CreateObject("MSXML2.XMLHTTP")
  On Error Resume Next
  http.Open "GET", url, False
  http.Send
  If http.Status <> 200 Then
    MsgBox "Erro ao carregar a página: " & http.Status & " " & http.statusText
    Exit Sub
  End If

  Set htmlDoc = CreateObject("htmlfile")
  htmlDoc.Open
  htmlDoc.Write http.responseText
  htmlDoc.Close

  Set links = htmlDoc.getElementsByTagName("a")
  linkList = ""
  For i = 0 To links.length - 1
    linkHref = links.item(i).href
    If linkHref <> "" Then
      linkList = linkList & linkHref & vbCrLf
    End If
  Next

  If linkList = "" Then
    linkList = "Nenhum link encontrado."
  End If

  document.getElementById("output").value = linkList
End Sub
</script>
</head>
<body>
<h2>HTA Link Scraper com XMLHTTP</h2>
<p>Insira a URL para raspar os links:</p>
<input type="text" id="urlInput" style="width: 400px;" placeholder="https://exemplo.com"/>
<button onclick="ScrapeLinks">Raspar Links</button>
<br/><br/>
<textarea id="output" style="width: 600px; height: 300px;" readonly></textarea>
</body>
</html>


